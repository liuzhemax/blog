import{_ as i,c as e,e as a,o as t}from"./app-D5peQ_E2.js";const l="/images/44B7D7962FFC4A6084E5B03245B92B45clipboard.png",n="/images/B5A0EFF109924D819F7F247722B89244clipboard.png",p="/images/FE0CA664ABC643C6AC7DF7A84860042Cclipboard.png",h="/images/4D8950519EAC4C08B9D400C984FD4308clipboard.png",d={};function k(r,s){return t(),e("div",null,s[0]||(s[0]=[a('<h2 id="kubeconfig配置文件" tabindex="-1"><a class="header-anchor" href="#kubeconfig配置文件"><span>kubeconfig配置文件</span></a></h2><p>kube-apiserver两个端口：</p><ul><li><p>localhost:8080 非安全端口，是kubectl默认先连接8080，如果你配置kubeconfig（.kube/config）就直接走这个配置连接的安全端口</p></li><li><p>masterip:6443 安全端口</p></li></ul><p>命令行指定配置文件：</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">kubectl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> get</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> node</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --kubeconfig=admin.conf</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>拷贝认证文件到其他节点的（.kube/config）下：</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">scp</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> .kube/config</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> root@192.168.0.12:.kube/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>kubectl使用kubeconfig认证文件连接K8s集群， 使用kubectl config指令生成kubeconfig文件。</p><p><img src="'+l+'" alt=""></p><h2 id="kubectl管理命令概要" tabindex="-1"><a class="header-anchor" href="#kubectl管理命令概要"><span>kubectl管理命令概要</span></a></h2><p><img src="'+n+'" alt=""></p><p>官方文档参考地址：https://kubernetes.io/zh/docs/reference/kubectl/overview/</p><p><img src="'+p+`" alt=""></p><h2 id="牛刀小试-快速部署一个网站" tabindex="-1"><a class="header-anchor" href="#牛刀小试-快速部署一个网站"><span>牛刀小试，快速部署一个网站</span></a></h2><p>使用Deployment控制器部署镜像：</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">kubectl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> create</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> deployment</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> web</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --image=lizhenliang/java-demo</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">kubectl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> get</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> deploy,pods</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>使用Service将Pod暴露出去：</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">kubectl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> expose</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> deployment</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> web</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --port=80</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --target-port=8080</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --type=NodePort</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">kubectl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> get</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> service</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>访问应用：</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">http://NodeIP:Port</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> # 端口随机生成，通过get svc获取</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="基本资源概念" tabindex="-1"><a class="header-anchor" href="#基本资源概念"><span>基本资源概念</span></a></h2><ul><li><p>Pod：K8s最小部署单元，一组容器的集合</p></li><li><p>Deployment：最常见的控制器，用于更高级别部署和管理Pod</p></li><li><p>Service：为一组Pod提供负载均衡，对外提供统一访问入口</p></li><li><p>Label ：标签，附加到某个资源上，用于关联对象、查询和筛选</p></li><li><p>Namespaces ：命名空间，将对象逻辑上隔离，也利于权限控制</p></li></ul><h2 id="命名空间" tabindex="-1"><a class="header-anchor" href="#命名空间"><span>命名空间</span></a></h2><p>命名空间（Namespace）：Kubernetes将资源对象逻辑上隔离，从而形成多个虚拟集群。</p><p>应用场景：</p><ul><li><p>根据不同团队划分命名空间</p></li><li><p>根据项目划分命名空间</p></li></ul><p>kubectl get namespace</p><ul><li><p>default：默认命名空间</p></li><li><p>kube-system：K8s系统方面的命名空间</p></li><li><p>kube-public：公开的命名空间，谁都可以访问，</p></li><li><p>kube-node-lease：K8s内部命名空间</p></li></ul><p>两种方法指定资源命名空间：</p><ul><li><p>命令行加 -n</p></li><li><p>yaml资源元数据里指定namespace字段</p></li></ul><p>1、使用kubeadm搭建一个K8s集群</p><p>2、新建命名空间，在该命名空间中创建一个pod</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">kubectl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> create</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> namespace</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> azhe</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>3、创建一个deployment并暴露Service，可以在浏览器访问</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">kubectl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> create</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> deployment</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> java-demo</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --image=lizhenliang/java-demo</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -n</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> azhe</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">kubectl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> expose</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> deployment</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> java-demo</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --port</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 80</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --target-port=8080</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --type=NodePort</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">  -n</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> azhe</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>4、列出命名空间下指定标签pod</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">kubectl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> get</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pod</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -n</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> azhe</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --show-labels</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">kubectl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> get</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pod</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -l</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> app=java-demo</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -n</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> azhe</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">kubectl</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> get</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> pod,svc,deploy</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -o</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> wide</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -n</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> azhe</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  #查看azhe命名空间下的pod，svc,deploy资源</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+h+'" alt=""></p><p>注：自由发挥，实现需求即可</p>',39)]))}const o=i(d,[["render",k],["__file","index.html.vue"]]),u=JSON.parse(`{"path":"/notes/k8s/uf1ihb99/","title":"kubectl命令行管理工具","lang":"zh-CN","frontmatter":{"title":"kubectl命令行管理工具","createTime":"2024/09/29 10:25:35","permalink":"/notes/k8s/uf1ihb99/","head":[["script",{"id":"check-dark-mode"},";(function () {const um= localStorage.getItem('vuepress-theme-appearance') || 'auto';const sm = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;const isDark = um === 'dark' || (um !== 'light' && sm);document.documentElement.dataset.theme = isDark ? 'dark' : 'light';})();"],["script",{"id":"check-mac-os"},"document.documentElement.classList.toggle('mac', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))"]]},"headers":[{"level":2,"title":"kubeconfig配置文件","slug":"kubeconfig配置文件","link":"#kubeconfig配置文件","children":[]},{"level":2,"title":"kubectl管理命令概要","slug":"kubectl管理命令概要","link":"#kubectl管理命令概要","children":[]},{"level":2,"title":"牛刀小试，快速部署一个网站","slug":"牛刀小试-快速部署一个网站","link":"#牛刀小试-快速部署一个网站","children":[]},{"level":2,"title":"基本资源概念","slug":"基本资源概念","link":"#基本资源概念","children":[]},{"level":2,"title":"命名空间","slug":"命名空间","link":"#命名空间","children":[]}],"readingTime":{"minutes":2.02,"words":605},"filePathRelative":"notes/k8s/introduction/3.kubectl命令行管理工具.md"}`);export{o as comp,u as data};
