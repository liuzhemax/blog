import{_ as i,c as a,e as n,o as e}from"./app-D5peQ_E2.js";const l="/images/28FFC6E76CF74B7998177B37E38B8CC3clipboard.png",t="/images/E526BCB26C124AAA827A01F7FC7F8B15clipboard.png",p="/images/F8B6883F8C284B8C8F143E4F7A6A925Cclipboard.png",h="/images/85B6BA3875574C0586DE3DD18222F147clipboard.png",d="/images/720B9DE3ADAD410FAADA60EAB790C6C8clipboard.png",k="/images/329F3745C6FB4031AEDFE1B8C66B888Bclipboard.png",r="/images/024B2666B3EF4516B6F40DF20E9B263Eclipboard.png",c="/images/A1F53D9FA80847F69B3AA20BD5217807clipboard.png",A="/images/8A84C888BEED4239B65702E7ECA2BE33clipboard.png",v="/images/BC30FBD40ABE48568CB60D65681CFFCDclipboard.png",u="/images/432F32C7016A472E8515A5A99A7467FAclipboard.png",g="/images/8673BFB65C27405BAA5F82E4C77E932Bclipboard.png",m="/images/8DA9181865E14D00A8FAE00FD7DEA8BCclipboard.png",b="/images/C88EA42C67E944AEA3FCC873006AD32Aclipboard.png",o="/images/C09FB32391AF46C9B68D6F7E1D2B1B5Dclipboard.png",y="/images/4966CE8B45B34D61BBE81B9D34F0CD78clipboard.png",D="/images/BF43CE3AE01B400EB0D563D60A43462Aclipboard.png",C="/images/21779EEC6FA14E3BB33B062E0260B6AAclipboard.png",B="/images/A8443F325B964323B52B235D31702C73clipboard.png",E="/images/1383868802C447B69BDD70FD2259B833clipboard.png",F="/images/FD1F081CEEDC4B03AE47FC06CC91C7B8clipboard.png",V="/images/152EFB492576489F915684E9C07FAA2Eclipboard.png",x="/images/B72C8E5F6D944A7DB06EE9293FB2E740clipboard.png",_="/images/8FEACF78569D490B89E18A61471B971Fclipboard.png",q="/images/004FB4DA579D42B7B655B62B2D5C5EF9clipboard.png",f="/images/DD4111BC15A7435B8705604525DD8D3Fclipboard.png",w="/images/AFC74B98D3B94D7BB2A2AEB879B9CD7Cclipboard.png",L="/images/50895149528F4150B032CB05B050795Dclipboard.png",S="/images/D0A47CBD70C147A4A0FEAE1FA00CFF70clipboard.png",N={};function $(R,s){return e(),a("div",null,s[0]||(s[0]=[n(`<h2 id="chart模板-函数与管道" tabindex="-1"><a class="header-anchor" href="#chart模板-函数与管道"><span>Chart模板：函数与管道</span></a></h2><p>常用函数：</p><ul><li><p>quote：将值转换为字符串，即加双引号</p></li><li><p>default：设置默认值，如果获取的值为空则为默认值</p></li><li><p>indent和nindent：缩进字符串</p></li><li><p>toYaml：引用一块YAML内容</p></li><li><p>其他函数：upper、title等</p><pre><code>        upper:  将值修改为大写

        title:  将值首字母修改为大写
</code></pre></li></ul><p>quote：将值转换为字符串，即加双引号</p><p>示例：nodeSelector标签的值用了true正常使用会报错，这是因为它是关键字，需要加引号才可以。</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#vi mychart/values.yaml </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">replicaCount:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">image:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  repository:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  tag:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">latest</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">selectorLabels:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">nginx</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">nodeSelector:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  gpu:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#vi mychart/templates/deploy.yaml </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">apiVersion:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apps/v1</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">kind:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Deployment</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">metadata:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  labels:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    app:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> web2</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  name:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Release.Name }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">spec:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  replicas:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.replicaCount }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  selector:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    matchLabels:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      app:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.selectorLabels }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  template:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    metadata:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      labels:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        app:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.selectorLabels }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    spec:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      nodeSelector:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        gpu:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ quote .Values.nodeSelector.gpu }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      containers:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> image:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.image.repository }}:{{ .Values.image.tag }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        name:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">apiVersion:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> v1</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">kind:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Service</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">metadata:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  labels:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    app:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> web2</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  name:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Release.Name }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">spec:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  ports:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> port:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 80</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    protocol:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> TCP</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    targetPort:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 80</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  selector:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    app:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.selectorLabels }}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>验证部署</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">helm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> web2</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --dry-run</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> mychart/</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">helm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> web2</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> mychart/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="`+l+'" alt=""></p><p><img src="'+t+`" alt=""></p><p>default：设置默认值，如果获取的值为空则为默认值</p><p>示例：以防止忘记定义而导致模板文件缺少字段无法创建资源，这时可以为字段定义一个默认值。</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#vi mychart/values.yaml </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">replicaCount:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">image:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  repository:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  tag:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">latest</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">selectorLabels:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">nginx</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">nodeSelector:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  gpu:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">labels:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  app:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#vi mychart/templates/deploy.yaml </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">apiVersion:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apps/v1</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">kind:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Deployment</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">metadata:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  labels:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    app:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.labels.app | default &quot;web2&quot; }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  name:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Release.Name }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">spec:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  replicas:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.replicaCount }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  selector:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    matchLabels:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      app:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.selectorLabels }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  template:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    metadata:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      labels:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        app:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.selectorLabels }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    spec:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      nodeSelector:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        gpu:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ quote .Values.nodeSelector.gpu }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      containers:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> image:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.image.repository }}:{{ .Values.image.tag }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        name:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>验证部署</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">helm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> web3</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --dry-run</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> mychart/</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">helm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> web3</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  mychart/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>这里用到了管道符“|”，前面的值传递后函数验证是否为空。</p><p><img src="`+p+'" alt=""></p><p><img src="'+h+'" alt=""></p><p>indent和nindent函数都是缩进字符串，主要区别在于nindent会在缩进前多添加一个换行符。</p><p>示例：</p><p><img src="'+d+'" alt=""></p><p><img src="'+k+`" alt=""></p><p>toYaml：引用一块YAML内容</p><p>示例：在values.yaml里写结构化数据，引用内容块</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#vi mychart/values.yaml </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">replicaCount:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">image:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  repository:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  tag:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">latest</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">selectorLabels:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">nginx</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">nodeSelector:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  gpu:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">labels:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  app:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">resources:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  limits:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    cpu:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 100m</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    memory:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 128Mi</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  requests:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    cpu:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 100m</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    memory:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 128Mi</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#vi mychart/templates/deploy.yaml </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">apiVersion:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apps/v1</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">kind:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Deployment</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">metadata:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  labels:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    app:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.labels.app | default &quot;web2&quot; }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  name:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Release.Name }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">spec:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  replicas:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.replicaCount }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  selector:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    matchLabels:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      app:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.selectorLabels }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  template:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    metadata:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      labels:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        app:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.selectorLabels }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    spec:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      nodeSelector:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        gpu:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ quote .Values.nodeSelector.gpu }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      containers:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> image:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.image.repository }}:{{ .Values.image.tag }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        name:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        resources:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">          {{ toYaml .Values.resources | nindent 10 }}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>验证</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">helm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> web4</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --dry-run</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /root/mychart/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="`+r+'" alt=""></p><p><img src="'+c+'" alt=""></p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">helm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> web4</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --set</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> resources.limits.cpu=</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">200m</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --dry-run</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /root/mychart/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="'+A+'" alt=""></p><h2 id="chart模板-流程控制" tabindex="-1"><a class="header-anchor" href="#chart模板-流程控制"><span>Chart模板：流程控制</span></a></h2><p>Helm模板语言提供以下流程控制语句：</p><ul><li><p>if/else：条件判断</p></li><li><p>range：循环</p></li><li><p>with：指定变量作用域</p></li></ul><h2 id="chart模板-流程控制之if-else" tabindex="-1"><a class="header-anchor" href="#chart模板-流程控制之if-else"><span>Chart模板：流程控制之if/else</span></a></h2><p><img src="'+v+`" alt=""></p><p>条件判断：根据不同的条件做不同的行为</p><p>语法：</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">{{ if &lt;表达式&gt; }}</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    # 做某事 </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">{{ else if &lt;表达式&gt; }}</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    # 做某事 </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">{{ else }}</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    # 默认 </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">{{ end }}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>示例：部署一个应用，在没明确启用ingress时，默认情况下不启用</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># values.yaml</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ingress:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  enabled:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#vi mychart/templates/ingress.yaml </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">{{ if .Values.ingress.enabled }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">apiVersion:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> networking.k8s.io/v1</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">kind:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Ingress</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">metadata:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  name:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> minimal-ingress</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  annotations:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    nginx.ingress.kubernetes.io/rewrite-target:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">spec:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  rules:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> http:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      paths:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> path:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /testpath</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        pathType:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Prefix</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        backend:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">          service:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">            name:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> test</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">            port:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">              number:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 80</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">{{ end }}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>验证</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">helm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> web1</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --set</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ingress.enabled=</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;">true</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --dry-run</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /root/mychart/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="`+u+'" alt=""></p><p><img src="'+g+`" alt=""></p><p>如果值为以下几种情况则为false：</p><ul><li><p>一个布尔类型 false</p></li><li><p>一个数字 0</p></li><li><p>一个空的字符串</p></li><li><p>一个 nil（空或 null）</p></li><li><p>一个空的集合（ map、 slice、 tuple、 dict、 array）</p></li></ul><p>条件表达式也支持操作符：</p><ul><li><p>eq 等于</p></li><li><p>ne 不等于</p></li><li><p>lt 小于</p></li><li><p>gt 大于</p></li><li><p>and 逻辑与</p></li><li><p>or 逻辑或</p></li></ul><p>示例：如果是一个空的集合则不启用资源配额</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#vi mychart/values.yaml </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">replicaCount:</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">image:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  repository:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  tag:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">latest</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">selectorLabels:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">nginx</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">nodeSelector:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  gpu:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> true</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">labels:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  app:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">resources:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {}</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#  limits:</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#    cpu: 100m</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#    memory: 128Mi</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#  requests:</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#    cpu: 100m</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#    memory: 128Mi</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ingress:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  enabled:</span><span style="--shiki-light:#1E754F;--shiki-dark:#4D9375;"> false</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#vi mychart/templates/deploy.yaml </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">apiVersion:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apps/v1</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">kind:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Deployment</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">metadata:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  labels:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    app:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.labels.app | default &quot;web2&quot; }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  name:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Release.Name }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">spec:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  replicas:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.replicaCount }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  selector:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    matchLabels:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      app:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.selectorLabels }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  template:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    metadata:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      labels:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        app:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.selectorLabels }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    spec:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      nodeSelector:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        gpu:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ quote .Values.nodeSelector.gpu }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      containers:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> image:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.image.repository }}:{{ .Values.image.tag }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        name:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        {{- if .Values.resources }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        resources:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">          {{- toYaml .Values.resources | nindent 10 }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        {{- end }}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>验证渲染结果：</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">helm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">  install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> test</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --dry-run</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> mychart/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="`+m+'" alt=""></p><p><img src="'+b+'" alt=""></p><p>渲染结果会发现有多余的空行，这是因为模板渲染时会将 指令删除，所以原有的位置就空白了。可以使用横杠“-” 消除空</p><h2 id="chart模板-流程控制之range" tabindex="-1"><a class="header-anchor" href="#chart模板-流程控制之range"><span>Chart模板：流程控制之range</span></a></h2><p><img src="'+o+`" alt=""></p><p>循环：一般用于遍历序列结构的数据。例如序列、键值</p><p>语法：</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">{{ range &lt;值&gt; }}</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">    # 引用内容 </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">{{ end }}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>示例：遍历数据</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#vi mychart/values.yaml </span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">test</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> -</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 1</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> -</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 2</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> -</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;"> 3</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#vi mychart/templates/configmap.yaml</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">apiVersion:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> v1</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">kind:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ConfigMap</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">metadata:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  name:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Release.Name }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">data:</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">  test</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">:</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  {{- range.Values.test }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    {{ . }}</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">     # 引用当前元素</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  {{- end }}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>验证渲染结果</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">helm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> web1</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --dry-run</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> mychart/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="`+y+'" alt=""></p><p><img src="'+D+`" alt=""></p><h2 id="chart模板-流程控制之with" tabindex="-1"><a class="header-anchor" href="#chart模板-流程控制之with"><span>Chart模板：流程控制之with</span></a></h2><p>with：指定变量作用域</p><p>语法：</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">{{ with &lt;值&gt; }}</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  # 限制范围 </span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">{{ end }}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>with语句可以允许将当前范围 . 设置为特定的对象，比如我们前面一直使用 的 .Values.nodeSelecotr，我们可以使用 with来将 . 范围指向 .Values.nodeSelecotr：</p><p>示例：</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#vi mychart/values.yaml </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">labels:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  operation:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">ms</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  app:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">gateway</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#vi mychart/templates/deploy.yaml </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">apiVersion:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apps/v1</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">kind:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Deployment</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">metadata:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  labels:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    {{- with .Values.labels }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    operation:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .operation }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    app:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .app }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    {{- end }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  name:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Release.Name }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">spec:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  replicas:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.replicaCount }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  selector:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    matchLabels:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      app:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.selectorLabels }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  template:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    metadata:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      labels:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        app:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.selectorLabels }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    spec:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      nodeSelector:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        gpu:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ quote .Values.nodeSelector.gpu }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      containers:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> image:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.image.repository }}:{{ .Values.image.tag }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        name:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        {{- if .Values.resources }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        resources:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">          {{- toYaml .Values.resources | nindent 10 }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        {{- end }}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>验证渲染结果</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">helm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> web1</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --dry-run</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> mychart/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="`+C+'" alt=""></p><p><img src="'+B+`" alt=""></p><p>with块限制了变量作用域，也就是无法直接引用模板对象，例 如.Values、.Release，如果还想使用，可以定义变量来解决该问题。</p><p>示例：</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#vi mychart/templates/deploy.yaml </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">apiVersion:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apps/v1</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">kind:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Deployment</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">metadata:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  labels:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    {{- $rs := .Values.replicaCount }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    {{- with .Values.labels }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    operation:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .operation }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    app:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .app }}{{ $rs }}</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> #   test: {{ $rs }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    {{- end }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  name:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Release.Name }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">spec:</span></span>
<span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>验证</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">helm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> web1</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --dry-run</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> mychart/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="`+E+'" alt=""></p><p><img src="'+F+'" alt=""></p><p>或者</p><p><img src="'+V+`" alt=""></p><h2 id="chart模板-变量" tabindex="-1"><a class="header-anchor" href="#chart模板-变量"><span>Chart模板：变量</span></a></h2><p>变量是实际应用中不多，但有时候结合with、range能更好处理数据。</p><p>示例：k8s变量是键值，可以range遍历生成</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#vi mychart/values.yaml </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">env:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  NAME:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">gateway</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  JAVA_OPTS:</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;"> &quot;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">-Xmx1G</span><span style="--shiki-light:#B5695977;--shiki-dark:#C98A7D77;">&quot;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#vi mychart/templates/deploy.yaml </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">apiVersion:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apps/v1</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">kind:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Deployment</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">metadata:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  labels:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    {{- $rs := .Values.replicaCount }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    {{- with .Values.labels }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    operation:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .operation }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    app:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .app }}{{ $.Values.replicaCount }}</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> #   test: {{ $rs }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    {{- end }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  name:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Release.Name }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">spec:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  replicas:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.replicaCount }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  selector:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    matchLabels:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      app:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.selectorLabels }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  template:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    metadata:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      labels:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        app:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.selectorLabels }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    spec:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      nodeSelector:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        gpu:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ quote .Values.nodeSelector.gpu }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      containers:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">      -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> image:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.image.repository }}:{{ .Values.image.tag }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        name:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> nginx</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        {{- if .Values.resources }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        resources:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">          {{- toYaml .Values.resources | nindent 10 }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        {{- end }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        env:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        {{- range $k,$v := .Values.env }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        -</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> name:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ $k }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">          value:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ quote $v }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">        {{- end }}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>验证渲染结果：</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">helm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> web1</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --dry-run</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> mychart/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="`+x+'" alt=""></p><p><img src="'+_+`" alt=""></p><h2 id="chart模板-命名模板" tabindex="-1"><a class="header-anchor" href="#chart模板-命名模板"><span>Chart模板：命名模板</span></a></h2><p>命名模板类似于开发语言中的函数。指一段可以直接被另一段程序或代码引用的程序或代码。 在编写chart时，可以将一些重复使用的内容写在命名模板文件中供公共使用，这样可减少重 复编写程序段和简化代码结构。</p><p>命名模块使用define定义，template或include引入，在templates目录中默认下划线开头的 文件为公共模板（helpers.tpl）。</p><p>示例：资源名称生成指令放到公共模板文件，作为所有资源名称</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#vi mychart/templates/_helpers.tpl </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">{{- define &quot;fullname&quot; -}}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">{{- .Chart.Name -}}-{{ .Release.Name }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">{{- end -}}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#vi mychart/templates/deploy.yaml </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">apiVersion:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apps/v1</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">kind:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Deployment</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">metadata:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  labels:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    {{- $rs := .Values.replicaCount }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    {{- with .Values.labels }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    operation:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .operation }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    app:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .app }}{{ $.Values.replicaCount }}</span></span>
<span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"> #   test: {{ $rs }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    {{- end }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  name:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ template &quot;fullname&quot; . }}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>验证渲染结果：</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">helm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> web1</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --dry-run</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> mychart/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="`+q+'" alt=""></p><p><img src="'+f+`" alt=""></p><p>template指令是将一个模板包含在另一个模板中的方法。但是，template函 数不能用于Go模板管道。为了解决该问题，引入include指令。</p><p>示例：</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#vi mychart/templates/_helpers.tpl </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">{{- define &quot;labels&quot; -}}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">operation:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.labels.operation }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">app:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ .Values.labels.app }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">{{- end -}}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">#vi mychart/templates/deploy.yaml </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">apiVersion:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> apps/v1</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">kind:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> Deployment</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">metadata:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  labels:</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">    {{- include &quot;labels&quot; .| nindent 4 }}</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">  name:</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> {{ template &quot;fullname&quot; . }}</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>验证渲染结果：</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">helm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> web1</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --dry-run</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> mychart/</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="`+w+'" alt=""></p><p><img src="'+L+`" alt=""></p><h2 id="带你写一个通用的chart" tabindex="-1"><a class="header-anchor" href="#带你写一个通用的chart"><span>带你写一个通用的Chart</span></a></h2><ol><li><p>先创建模板示例 helm create demo</p></li><li><p>修改Chart.yaml，Values.yaml，参考示例预留变动的字段值</p></li><li><p>在templates目录下准备部署应用所需的yaml文件，并添加指令引用 Values.yaml字段</p></li><li><p>将重复使用的内容作为命名模板</p></li><li><p>使用Chart结合参数部署多个同类服务</p></li></ol><p><a href="/attachments/D1634A79483D4B0F8BAF5730F9A04D5Ademo-0.1.0.tgz">demo-0.1.0.tgz</a></p><h2 id="使用harbor作为chart仓库" tabindex="-1"><a class="header-anchor" href="#使用harbor作为chart仓库"><span>使用Harbor作为Chart仓库</span></a></h2><p>Harbor是一个主流的镜像仓库系统，在 v1.6 版本以后的 harbor 中新增加了 helm charts 的管理功能，可以存储Chart文件。</p><p>使用步骤：</p><p>1、启用Harbor的Chart仓库服务</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># ./install.sh --with-chartmuseum</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>启用后，默认创建的项目就带有helm charts功能了。</p><p>2、安装push插件</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">helm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> plugin</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> https://github.com/chartmuseum/helm-push</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ls</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /root/.local/share/helm/plugins/helm-push/</span><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;">  #家目录</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>3、推送</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># helm push demo-0.1.0.tgz --username=admin --password=Harbor12345 http://192.168.0.13/chartrepo/library</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p><img src="`+S+`" alt=""></p><p>4、添加repo</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">helm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> repo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> add</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> myrepo</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --username=admin</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --password=Harbor12345</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> http://192.168.0.13:/chartrepo/library</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">helm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> repo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> update</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">helm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> repo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> list</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>5、部署</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#A0ADA0;--shiki-dark:#758575DD;"># helm install web --version 0.1.0 myrepo/demo   #--version指定chart版本，如果未指定，使用最新版本</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">helm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> install</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> web1</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --set</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> service.type=NodePort</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> --set</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> service.nodeport=</span><span style="--shiki-light:#2F798A;--shiki-dark:#4C9A91;">30010</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> myrepo/demo</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="公共chart仓库" tabindex="-1"><a class="header-anchor" href="#公共chart仓库"><span>公共Chart仓库</span></a></h2><p>国内Chart仓库，可直接使用它们制作好的包：</p><ul><li><p>微软仓库（http://mirror.azure.cn/kubernetes/charts/）</p></li><li><p>阿里云仓库（https://kubernetes.oss-cn-hangzhou.aliyuncs.com/charts ）</p></li><li><p>官方仓库（https://hub.kubeapps.com/charts/incubator）</p></li></ul><p>添加仓库方式：</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">helm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> repo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> add</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> stable</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> http://mirror.azure.cn/kubernetes/charts</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">helm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> repo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> add</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> aliyun</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> https://kubernetes.oss-cn-hangzhou.aliyuncs.com/charts</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">helm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> repo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> update</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;"> </span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">helm</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> repo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> list</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,145)]))}const P=i(N,[["render",$],["__file","index.html.vue"]]),z=JSON.parse(`{"path":"/notes/k8s/lo8jgp54/","title":"kubernetes应用包管理器helm下","lang":"zh-CN","frontmatter":{"title":"kubernetes应用包管理器helm下","createTime":"2024/09/29 12:15:56","permalink":"/notes/k8s/lo8jgp54/","head":[["script",{"id":"check-dark-mode"},";(function () {const um= localStorage.getItem('vuepress-theme-appearance') || 'auto';const sm = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;const isDark = um === 'dark' || (um !== 'light' && sm);document.documentElement.dataset.theme = isDark ? 'dark' : 'light';})();"],["script",{"id":"check-mac-os"},"document.documentElement.classList.toggle('mac', /Mac|iPhone|iPod|iPad/i.test(navigator.platform))"]]},"headers":[{"level":2,"title":"Chart模板：函数与管道","slug":"chart模板-函数与管道","link":"#chart模板-函数与管道","children":[]},{"level":2,"title":"Chart模板：流程控制","slug":"chart模板-流程控制","link":"#chart模板-流程控制","children":[]},{"level":2,"title":"Chart模板：流程控制之if/else","slug":"chart模板-流程控制之if-else","link":"#chart模板-流程控制之if-else","children":[]},{"level":2,"title":"Chart模板：流程控制之range","slug":"chart模板-流程控制之range","link":"#chart模板-流程控制之range","children":[]},{"level":2,"title":"Chart模板：流程控制之with","slug":"chart模板-流程控制之with","link":"#chart模板-流程控制之with","children":[]},{"level":2,"title":"Chart模板：变量","slug":"chart模板-变量","link":"#chart模板-变量","children":[]},{"level":2,"title":"Chart模板：命名模板","slug":"chart模板-命名模板","link":"#chart模板-命名模板","children":[]},{"level":2,"title":"带你写一个通用的Chart","slug":"带你写一个通用的chart","link":"#带你写一个通用的chart","children":[]},{"level":2,"title":"使用Harbor作为Chart仓库","slug":"使用harbor作为chart仓库","link":"#使用harbor作为chart仓库","children":[]},{"level":2,"title":"公共Chart仓库","slug":"公共chart仓库","link":"#公共chart仓库","children":[]}],"readingTime":{"minutes":6.85,"words":2054},"filePathRelative":"notes/k8s/upgrade/4.kubernetes应用包管理器helm下.md"}`);export{P as comp,z as data};
